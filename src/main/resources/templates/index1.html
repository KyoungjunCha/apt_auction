<html layout:decorate="~{layout}">
<!-- content -->
<div layout:fragment="content" class="container video-background"> <!--뒤에 video-background 빼면 header footer 안나옴-->
    <video autoplay muted loop class="video">
        <source src="as2.mp4" type="video/mp4"> <!--배경화면-->
    </video>


    <div class=" content-box main-index index1">
        <form th:action="@{/auction/list/custom-filters}" method="post" id="myForm" class="index1-form">
            <div id="input-info">
                <table class="styled-table1">
                    <ul id="index1-ul">
                        <p class="index1-p">*본인의 입찰 다능한 금액을 입력해주세요.</p>
                        <li>
                            <input type="number" name="price" id="price" min="0" max="10000000000"
                                placeholder="원하시는 금액을 적어주세요.">원
                        </li>


                        <p class="index1-p">*희망 평수와 지역을 선택해 주세요.</p>
                        <li id="index1-li2">
                            <select id="locationsDo" name="locationsDo">
                                <option value="">선택하세요</option>
                            </select>
                            <label for="locations">도</label>


                            <select id="locationsSi" name="locationsSi">
                                <option value="">선택하세요</option>
                            </select>
                            <label for="locations">시</label>
                            <input type="number" name="apartmentSize" id="apartmentSize" min="5" max="50"
                                placeholder="평수">평
                        </li>
                        <p class="index1-p">
                            <a href="javascript:openpopup()" id="popupbtn">*희망낙찰가 조정 세부사항 확인하기(클릭)</a>
                        </p>
                    </ul>
                </table>
            </div>
            <input type="hidden" id="addressSidoInput" name="addressSido" value="">
            <div id="index1-submit" class="m-auto">
                <button id="index1-submint" type="submit">확인</button>
            </div>
        </form>
    </div>
</div>
<script layout:fragment="script2" th:inline="javascript">
    // 팝업창
    // 버튼 엘리먼트 가져오기
    // var popupbtn = document.getElementById("popupbtn");

    function openPopup() {
        // 팝업 창의 URL
        var price = document.getElementById("price").value;
        var apartmentSize = document.getElementById("apartmentSize").value;
        var popupUrl = "/auction/popup";
        var popupUrl = "/auction/popup?apartmentSize=" + apartmentSize;
        popupUrl += '&price=' + price;
        var name = "popup";
        // 팝업 창의 속성 (크기, 스크롤바 등)
        var popupOptions = "top=100, left=200, width=1050px,height=800px,scrollbars=yes, location=no";

        // 팝업 창 열기
        window.open(popupUrl, name, popupOptions);
    }

    // 이제 버튼 클릭 이벤트를 설정
    var popupbtn = document.getElementById("popupbtn");
    popupbtn.addEventListener("click", function (event) {
        openPopup(); // openpopup 함수 호출
    });


    //  지역 객체선언
    const locations = {
        "서울특별시": ["서울특별시"],
        "인천광역시": ["인천광역시"],
        "세종특별자치시": ["세종특별자치시"],
        "경기도": ["수원시", "성남시", "의정부시", "안양시", "부천시", "광명시", "동두천시", "평택시", "안산시", "고양시", "과천시", "구리시", "남양주시", "오산시", "시흥시", "군포시", "의왕시", "하남시", "용인시", "파주시", "이천시", "안성시", "김포시", "화성시", "광주시", "양주시", "포천시", "여주시"],
        "강원특별자치도": ["춘천시", "원주시", "강릉시", "동해시", "태백시", "속초시", "삼척시"],
        "충청북도": ["대전광역시", "청주시", "충주시", "제천시"],
        "충청남도": ["천안시", "공주시", "보령시", "아산시", "서산시", "논산시", "계룡시", "당진시"],
        "전라북도": ["전주시", "군산시", "익산시", "정읍시", "남원시", "김제시"],
        "전라남도": ["광주광역시", "목포시", "여수시", "순천시", "나주시", "광양시"],
        "경상북도": ["대구광역시", "포항시", "경주시", "김천시", "안동시", "구미시", "영주시", "영천시", "상주시", "문경시", "경산시"],
        "경상남도": ["부산광역시", "울산광역시", "창원시", "진주시", "통영시", "사천시", "김해시", "밀양시", "거제시", "양산시"],
        "제주특별자치도": ["제주시", "서귀포시"]
    };

    const locationsDropdownDo = document.getElementById("locationsDo");
    const locationsDropdownSi = document.getElementById("locationsSi");




    // 도 목록을 생성
    for (const province in locations) {
        const optionDo = document.createElement("option");
        optionDo.value = province;
        optionDo.text = province;
        locationsDropdownDo.appendChild(optionDo);
    }

    // 도 선택 시 해당 시 목록을 업데이트
    locationsDropdownDo.addEventListener("change", function () {
        const selectedProvince = this.value;
        const cities = locations[selectedProvince];

        // 기존 시 목록을 지우고 새로운 시 목록을 추가
        locationsDropdownSi.innerHTML = "<option value=''>시 선택</option>";
        cities.forEach(city => {
            const optionSi = document.createElement("option");
            optionSi.value = city;
            optionSi.text = city;
            locationsDropdownSi.appendChild(optionSi);
        });

        console.log("locationsDo의 값:", selectedProvince);
    });

    var confirmButton = document.querySelector("form button[type='submit']");
    confirmButton.addEventListener("click", function (event) {
        // locationsDo와 locationsSi의 값을 가져옴
        const selectedDo = document.getElementById("locationsDo").value;
        const selectedSi = document.getElementById("locationsSi").value;

        // 두 값을 조합하여 addressSido로 설정 삼항 연산자 사용
        const addressSido = selectedDo + (selectedSi ? " " + selectedSi : "");
        if (selectedSi == "") {
            const filteredData = locations.filter(item => item.startsWith(selectedDo));
        }

        // addressSido 값을 설정
        document.getElementById("addressSidoInput").value = addressSido;
    });

</script>

</html>